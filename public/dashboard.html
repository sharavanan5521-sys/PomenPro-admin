<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PomenPro Admin · Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap (for the navbar collapse/toggler) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Your theme (kept after Bootstrap so it wins) -->
  <link rel="stylesheet" href="assets/styles.css" />
  <style>
    /* Layout + small visibility boosts without fighting your theme */
    main{max-width:1200px;margin:32px auto;padding:0 16px}
    .kpi-grid{display:grid;grid-template-columns:repeat(2,minmax(220px,1fr));gap:16px}
    .kpi-tile{background:var(--card,#0f1624);border:1px solid var(--border,#1f2937);border-radius:14px;padding:18px;box-shadow:var(--shadow,0 12px 36px rgba(0,0,0,.35))}
    .kpi-tile h3{margin:0 0 8px;font-size:1rem;color:var(--muted,#94a3b8);font-weight:600}
    .kpi-val{font-size:40px;line-height:1.1;font-weight:800;color:var(--text,#e5e7eb)}
    .panel{background:var(--card,#0f1624);border:1px solid var(--border,#1f2937);border-radius:14px;margin-top:20px;box-shadow:var(--shadow,0 12px 36px rgba(0,0,0,.35))}
    .panel h2{margin:0;padding:16px 20px;border-bottom:1px solid var(--border,#1f2937);font-size:18px;font-weight:700}
    .panel .inner{padding:8px 16px 20px}

    table.table{width:100%;border-collapse:collapse}
    table.table th,table.table td{padding:14px 12px;border-bottom:1px solid var(--border,#1f2937);vertical-align:middle}
    table.table thead th{color:var(--muted,#94a3b8);font-weight:700}
    table.table tbody td{color:var(--text,#e5e7eb)}

    .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-size:.8rem;font-weight:700}
    .badge.ok{background:#064e3b;color:#d1fae5}
    .badge.warn{background:#4b3f0a;color:#fde68a}
    .badge.meh{background:#172554;color:#c7d2fe}

    .actions{padding:8px 2px 0}
    .btn-green{background:#10b981;color:#fff;border:none;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn-green:focus{outline:2px solid #34d399;outline-offset:2px}
    .muted{color:var(--muted,#94a3b8);text-align:center}

    /* Jobs-page style bits */
    .id-cell{font-weight:800}
    .sub{display:block;font-size:.8rem;color:var(--muted,#94a3b8);margin-top:4px}
    .icon-pill{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%;background:rgba(99,102,241,.12);margin-right:10px}
    .icon-wrench{width:14px;height:14px;display:block}
    .td-notes{max-width:360px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .td-person{white-space:nowrap}
    .td-person .phone{display:block;font-size:.8rem;color:var(--muted,#94a3b8)}
  </style>
</head>
<body>
  <!-- Shared navbar gets injected here -->
  <div id="navbar"></div>

  <main>
    <section class="kpi-grid">
      <div class="kpi-tile">
        <h3>Total Technicians</h3>
        <div class="kpi-val" id="kpiTechs">—</div>
      </div>
      <div class="kpi-tile">
        <h3>Open Jobs</h3>
        <div class="kpi-val" id="kpiOpen">—</div>
      </div>
    </section>

    <div class="actions">
      <button id="btnCreateJob" class="btn-green">+ Create Job</button>
    </div>

    <section class="panel">
      <h2>Recent Jobs</h2>
      <div class="inner">
        <table class="table">
          <thead>
            <tr>
              <th style="min-width:220px">Display ID</th>
              <th>Status</th>
              <th>Assigned To</th>
              <th>Service Type</th>
              <th>Vehicle No</th>
              <th>Created</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody id="jobsTableBody">
            <tr><td colspan="7" class="muted">Loading…</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Load navbar first so its elements exist before dashboard.js touches them -->
  <script>
    fetch("assets/navbar.html")
      .then(r => r.text())
      .then(html => {
        document.getElementById("navbar").innerHTML = html;
        const here = location.pathname.split("/").pop() || "dashboard.html";
        document.querySelectorAll('#navbar a.nav-link').forEach(a => {
          const target = a.getAttribute('href');
          if (target === here) a.classList.add('active');
        });
      })
      .catch(() => console.warn("Navbar failed to load. Check assets/navbar.html path."));
  </script>

  <!-- Page logic (after navbar injection) -->
  <script type="module" src="js/dashboard.js"></script>

  <!-- Bootstrap JS (navbar toggler/collapse) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
